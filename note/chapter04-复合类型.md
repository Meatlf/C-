# chapter04-复合类型

## 4.3 string类简介



## 4.6 枚举

**小结**：本节介绍了枚举的**概念**、**使用方法**、**使用限制**、设置枚举量的值、枚举的取值范围等，本节的知识较为琐碎，所以笔记的内容较为粗略，具体还是要查看书本。

**相关章节**：第8章的swtich会使用到枚举。

**Q**：C++的enum工具的作用是什么？

**A**：C++的enum工具提供了另一种创建符号常量的方式，这种方式可以替代const。

**Q**：如何理解如下语句：

```c++
enum spectrum {red, orange, yellow, green, blue, violet, indigo, ultraviolet};
```

**A**：

1）让spectrum成为新类型的名称；spectrum被称为枚举（enumeration），就像struct变量被称为结构一样；

2）将red、orange、yellow等作为符号常量，它们对应整数值0~7,。这些常量叫作枚举量（enumerator）。

**Q**：如何声明枚举变量？

**A**：可以用枚举名来声明这种类型的变量：

```c++
spectrum band;		// band a variable of type spectrum
```

### 4.6.1 设置枚举变量的值

### 4.6.2 枚举的取值范围

## 4.7 指针和自由存储空间

**指针与C++基本原理**

**小结**：本段内容通过**何时分配数组空间**这件事说明了**编译阶段**和**运行阶段**之间的区别。

### 4.7.1 声明和初始化指针

**小结**：本小节介绍了如何**声明**和**初始化**指针，这对于熟悉C语言指针的人来说，没有什么新知识。

**Q**：如何理解以下语句？

```c++
int* p1, p2;
```

**A**：该语句创建了一个指针（p1）和一个int变量（p2）。

**声明**：和数组一样，指针都是基于其他类型的。

### 4.7.2 指针的危险

**警告**：一定要在对指针应用解除引用运算符（*）之前，将指针初始化为一个确定的、适当的地址。这是关于使用指针的金科玉律。

### 4.7.3 指针和数字

**小结**：本节介绍虽然计算机通常把地址当作整数来处理，但是从概念上看，指针与整数是截然不同的类型。

### 4.7.4 使用new来分配内存

**相关章节**：第9章的堆、栈概念。

Q：为什么说C++中分配内存的new运算符要比C中的malloc好？

A：

Q：为一个数据对象（可以是结构，也可以是基本类型）获得并指定分配内存的通用格式是什么?

A：

```c++
// 语法
typeName * pointer_name = new typeName;
// 实例
int * pn = new int;
```

### 4.7.5 使用delete释放内存

**小结**：本小节介绍了如何使用`delete`释放内存。

**Q**：如何使用`delete`释放内存？

**A**：示例如下：

```c++
int * pa = new int;	// allocate memory with new
...					// use the memroy
delete ps;			// free memory with delete when done
```

​	说明：

​	1）这将释放ps指向的内存，但不会删除指针ps本身。例如，可以将ps重新指向另一个新分配的内存块。

​	2）一定要**配对使用**new和delete；否则将发生内存泄漏（memory leak），也就是说，被分配的内存再也无法使用了。如果内存泄漏严重，则程序将由于不断寻找更多内存而终止。

​	3）不要尝试释放已经释放的内存块，C++标准指出，这样做的结果将是不确定的，这意味着什么情况都可能发生。

### 4.7.6 使用new来创建动态数组

**1.使用new创建动态数组**

```c++
int * psome = new int [10];	// get a block of 10 ints
delete [] psome;			// free a dynamic array
```

**原则**：

1）不要使用delete来释放不是new分配的内存；

2）不要使用delete释放同一个内存块两次；

3）如果使用new[]为数组分配内存，则应使用delete[]来释放；

4）如果使用new[]为一个实体分配内存，则应使用delete（没有方括号）来释放；

5）对空指针应用delete是安全的。

**2.使用动态数组**



## 4.10 数组的替代品

**模板类**vector和array是数组的替代品。

### 4.10.1 模板类vector

**Q**：如何理解模板类vector？

**A**：类似于string类，也是一种**动态数组**，可以在**运行阶段**设置vector对象的长度，可以在**末尾**附加新数据，还可以在**中间插入**新数据。可以看成是**new创建动态数组的替代品**。实际上，vector类确实使用new和delete来管理内存，但这种工作是**自动完成的**。

书本中给出了关于模板类vector的helloworld。
